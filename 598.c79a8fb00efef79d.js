"use strict";(self.webpackChunkundangan_festival=self.webpackChunkundangan_festival||[]).push([[598],{8598:(an,g,s)=>{s.r(g),s.d(g,{CheckinTamuModule:()=>tn});var m=s(9808),p=s(7850),u=s(4847),l=s(4999),f=s(6457),h=s(2340),n=s(5e3),C=s(8966),S=s(3071),w=s(9287),b=s(4383),k=s(1083),y=s(3457),d=s(3075),T=s(5245),x=s(7446),v=s(7423);function Z(i,o){if(1&i&&(n.ynx(0),n.TgZ(1,"option",19),n._uU(2),n.qZA(),n.BQk()),2&i){const t=o.$implicit;n.xp6(1),n.Q6J("value",t.nama),n.xp6(1),n.Oqu(t.nama)}}function J(i,o){if(1&i){const t=n.EpF();n.ynx(0),n.TgZ(1,"mat-checkbox",25),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(3);return a.checkAll(a.isCheckAll)}),n.qZA(),n.BQk()}}function N(i,o){if(1&i&&(n.ynx(0),n._uU(1),n.BQk()),2&i){const t=n.oxw(2).$implicit;n.xp6(1),n.hij(" ",t.label," ")}}function M(i,o){if(1&i&&(n.TgZ(0,"th",23),n.YNc(1,J,2,0,"ng-container",24),n.YNc(2,N,2,1,"ng-container",24),n.qZA()),2&i){const t=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf","isSelected"==t.type),n.xp6(1),n.Q6J("ngIf","isSelected"!=t.type)}}function A(i,o){if(1&i){const t=n.EpF();n.ynx(0),n.TgZ(1,"mat-checkbox",32),n.NdJ("ngModelChange",function(a){return n.CHM(t),n.oxw(2).$implicit.isSelected=a})("change",function(a){return n.CHM(t),n.oxw(2).$implicit.isSelected=a.checked}),n.qZA(),n.BQk()}if(2&i){const t=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngModel",t.isSelected)}}function Q(i,o){if(1&i){const t=n.EpF();n.TgZ(0,"button",35),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(3).$implicit;return n.oxw(2).checkIn(a.code)}),n._uU(1," CheckIn "),n.qZA()}}function U(i,o){if(1&i){const t=n.EpF();n.TgZ(0,"button",35),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(3).$implicit;return n.oxw(2).unCheck(a)}),n._uU(1," Uncheckin "),n.qZA()}}function Y(i,o){if(1&i&&(n.TgZ(0,"div",33),n.YNc(1,Q,2,0,"button",34),n.YNc(2,U,2,0,"button",34),n.qZA()),2&i){const t=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngIf",!t.isCheckin),n.xp6(1),n.Q6J("ngIf",t.isCheckin)}}function I(i,o){if(1&i){const t=n.EpF();n.TgZ(0,"span")(1,"a",36),n._uU(2),n.qZA(),n.TgZ(3,"mat-icon",37),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2).$implicit,c=n.oxw().$implicit;return n.oxw().copyText(a[c.key])}),n._uU(4,"file_copy"),n.qZA(),n.TgZ(5,"mat-icon",37),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2).$implicit,c=n.oxw().$implicit;return n.oxw().copyLink(a[c.key])}),n._uU(6,"link"),n.qZA()()}if(2&i){const t=n.oxw(2).$implicit,e=n.oxw().$implicit;n.xp6(1),n.Q6J("href",t[e.key],n.LSH),n.xp6(1),n.hij(" ",t[e.key],"")}}function O(i,o){1&i&&(n.ynx(0),n.TgZ(1,"span",38),n._uU(2," Sudah Checkin "),n.qZA(),n.BQk())}function $(i,o){1&i&&(n.ynx(0),n.TgZ(1,"span",39),n._uU(2," Belum Checkin "),n.qZA(),n.BQk())}function L(i,o){if(1&i&&(n.TgZ(0,"span"),n.YNc(1,O,3,0,"ng-container",24),n.YNc(2,$,3,0,"ng-container",24),n.qZA()),2&i){const t=n.oxw(2).$implicit,e=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf",t[e.key]),n.xp6(1),n.Q6J("ngIf",!t[e.key])}}function F(i,o){if(1&i&&(n.TgZ(0,"span",40),n._uU(1),n.qZA()),2&i){const t=n.oxw(2).$implicit,e=n.oxw().$implicit;n.xp6(1),n.hij(" ",t[e.key]," ")}}function D(i,o){if(1&i&&(n.TgZ(0,"div",28),n.YNc(1,A,2,1,"ng-container",29),n.YNc(2,Y,3,2,"div",30),n.YNc(3,I,7,2,"span",29),n.YNc(4,L,3,2,"span",29),n.YNc(5,F,2,1,"span",31),n.qZA()),2&i){const t=n.oxw(2).$implicit;n.Q6J("ngSwitch",t.type),n.xp6(1),n.Q6J("ngSwitchCase","isSelected"),n.xp6(1),n.Q6J("ngSwitchCase","isEdit"),n.xp6(1),n.Q6J("ngSwitchCase","link"),n.xp6(1),n.Q6J("ngSwitchCase","status")}}function E(i,o){if(1&i&&(n.TgZ(0,"td",26),n.YNc(1,D,6,5,"div",27),n.qZA()),2&i){const t=o.$implicit;n.xp6(1),n.Q6J("ngIf",!t.isEdit)}}function B(i,o){1&i&&(n.ynx(0,20),n.YNc(1,M,3,2,"th",21),n.YNc(2,E,2,1,"td",22),n.BQk()),2&i&&n.Q6J("matColumnDef",o.$implicit.key)}function H(i,o){1&i&&n._UZ(0,"tr",41)}function R(i,o){1&i&&n._UZ(0,"tr",42)}function P(i,o){1&i&&(n.TgZ(0,"div",43)(1,"div",44)(2,"span",45),n._uU(3,"Loading..."),n.qZA()()())}const j=function(){return[20,50,100]};let G=(()=>{class i{constructor(t,e,a,c,r){this.dialog=t,this.userService=e,this.clipboard=a,this.toastr=c,this.router=r,this.displayedColumns=f.z.map(_=>_.key),this.columnsSchema=f.z,this.dataSource=new l.by,this.valid={},this.i=0,this.isLoading=!1,this.srcSelect="",this.isCheckAll=!1}ngOnInit(){"true"!=localStorage.getItem("statusLogin")&&this.router.navigateByUrl("/login"),this.isLoading=!0,this.userService.getUsers().subscribe(e=>{e.map(a=>{let c=encodeURIComponent(a.nama);a.link=h.N.site+"?code="+a.code+"&nama="+c,a.download=h.N.site_url+"/undangan-pdf?code="+a.code+"&nama="+c}),this.dataSource.data=e.sort((a,c)=>a.isCheckin-c.isCheckin),this.isLoading=!1},e=>{console.log(e),this.isLoading=!1,this.showError("Terjadi Kesalahan")}),this.userService.getDataSrc().subscribe(e=>{this.dataSrc=e})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}copyText(t){console.log(t),this.dataSource.data.map(e=>{if(e.link==t){let a="Kepada Yth. *"+e.nama+"* \nDitempat. \nMengharap kehadiran Bapak/Ibu/Sdr di acara Festival Gandrung Sewu 2022 \nBuka Undangan : \nhttps://undangantamu.web.app/?code="+e.code+"&to="+encodeURI(e.nama)+"\n\n\n";this.clipboard.copy(a),this.showSuccess("Link Berhasil di Copy"),console.log(e,"data tamu")}})}copyLink(t){this.clipboard.copy(t),this.showSuccess("Link Berhasil di Copy")}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}checkAll(t){let e=this.dataSource.data;e.map((a,c)=>{e[c].isSelected=t?0:1}),this.dataSource.data=e,this.isCheckAll=!t}filterSrc(){let t={nama:"",asal:"",jenis_tamu:"",src:this.srcSelect};console.log(t),this.isLoading=!0,this.userService.search(t).subscribe(e=>{e.map(a=>{let c=encodeURIComponent(a.nama);a.link=h.N.site+"?code="+a.code+"&nama="+c,a.download=h.N.site_url+"/undangan-pdf?code="+a.code+"&nama="+c}),this.dataSource.data=e.sort((a,c)=>a.isCheckin-c.isCheckin),this.isLoading=!1})}clear(){this.isCheckAll=!1,this.srcSelect="",this.filterSrc()}unCheck(t){t.waktu_checkin="",t.isCheckin=!1,this.userService.updateUser(t).subscribe(e=>{e&&e.status&&(console.log(e),this.showSuccess("Reset checkin berhasil"))})}checkIn(t){this.userService.updateCheckin(t).subscribe(e=>{if(e&&"SUCCESS"==e.status){this.showSuccess(e.message);let a=this.dataSource.data;a.map((c,r)=>{c.code==t&&(a[r].isCheckin=e.data.isCheckin,a[r].waktu_checkin=e.data.waktu_checkin)}),this.dataSource.data=a}else this.showSuccess(e.message)},e=>{console.log(e),this.isLoading=!1,this.showError("Terjadi Kesalahan")})}checkinSelectedRows(){const t=this.dataSource.data.filter(e=>e.isSelected);t.length?(this.isLoading=!0,this.userService.updateCheckinSelected(t).subscribe(e=>{let a=this.dataSource.data;a.map((c,r)=>{let _=e.data.find(en=>en.code==c.code);_&&(a[r].isCheckin=_.isCheckin,a[r].waktu_checkin=_.waktu_checkin,a[r].isSelected=0)}),this.dataSource.data=a,this.isLoading=!1})):this.showError("data belum ada yg dicentang!")}showSuccess(t){this.toastr.success(t,"Success",{positionClass:"toast-top-right",timeOut:2500})}showError(t){this.toastr.error(t,"Error",{positionClass:"toast-top-right",timeOut:2500})}}return i.\u0275fac=function(t){return new(t||i)(n.Y36(C.uw),n.Y36(S.K),n.Y36(w.TU),n.Y36(b._W),n.Y36(k.F0))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-checkin-tamu"]],viewQuery:function(t,e){if(1&t&&(n.Gf(p.NW,5),n.Gf(u.YE,5)),2&t){let a;n.iGM(a=n.CRH())&&(e.paginator=a.first),n.iGM(a=n.CRH())&&(e.sort=a.first)}},decls:24,vars:9,consts:[[1,"container-fluid","pt-5"],[1,"row"],[1,"col-md-3"],[1,"btn","btn-sm","btn-danger","mb-2",3,"click"],[1,"col-md-3","mb-2"],["name","srcSelect","id","src",1,"form-control","select-src",3,"ngModel","change","ngModelChange"],["value",""],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-danger","btn-icon","button-clear",3,"click"],[1,"col-md-6"],[1,"form-group"],["placeholder","Masukkan Code / Nama / Asal Undangan ... ",1,"form-control",3,"keyup"],["input",""],["mat-table","","matSort","",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of users",3,"pageSizeOptions"],["class","spinner-wrapper",4,"ngIf"],[3,"value"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],[4,"ngIf"],[1,"mt-2","mr-2",3,"click"],["mat-cell",""],[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","btn-edit",4,"ngSwitchCase"],["class","default-column",4,"ngSwitchDefault"],["name","check",1,"mt-2","mr-2",3,"ngModel","ngModelChange","change"],[1,"btn-edit"],["mat-button","","class","button-remove",3,"click",4,"ngIf"],["mat-button","",1,"button-remove",3,"click"],["target","_blank",1,"link",3,"href"],[1,"icon-link",3,"click"],[1,"badge","badge-info"],[1,"badge","badge-danger"],[1,"default-column"],["mat-header-row",""],["mat-row",""],[1,"spinner-wrapper"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,e){1&t&&(n._UZ(0,"app-header"),n.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"button",3),n.NdJ("click",function(){return e.checkinSelectedRows()}),n._uU(5," CheckIn data Dicentang "),n.qZA()(),n.TgZ(6,"div",4)(7,"select",5),n.NdJ("change",function(){return e.filterSrc()})("ngModelChange",function(c){return e.srcSelect=c}),n.TgZ(8,"option",6),n._uU(9,"Filter Src"),n.qZA(),n.YNc(10,Z,3,2,"ng-container",7),n.qZA(),n.TgZ(11,"button",8),n.NdJ("click",function(){return e.clear()}),n.TgZ(12,"mat-icon"),n._uU(13,"clear"),n.qZA()()(),n.TgZ(14,"div",9)(15,"div",10)(16,"input",11,12),n.NdJ("keyup",function(c){return e.applyFilter(c)}),n.qZA()()()(),n.TgZ(18,"table",13),n.YNc(19,B,3,1,"ng-container",14),n.YNc(20,H,1,0,"tr",15),n.YNc(21,R,1,0,"tr",16),n.qZA(),n._UZ(22,"mat-paginator",17),n.qZA(),n.YNc(23,P,4,0,"div",18)),2&t&&(n.xp6(7),n.Q6J("ngModel",e.srcSelect),n.xp6(3),n.Q6J("ngForOf",e.dataSrc),n.xp6(8),n.Q6J("dataSource",e.dataSource),n.xp6(1),n.Q6J("ngForOf",e.columnsSchema),n.xp6(1),n.Q6J("matHeaderRowDef",e.displayedColumns),n.xp6(1),n.Q6J("matRowDefColumns",e.displayedColumns),n.xp6(1),n.Q6J("pageSizeOptions",n.DdM(8,j)),n.xp6(1),n.Q6J("ngIf",e.isLoading))},directives:[y.G,d.EJ,d.JJ,d.On,d.YN,d.Kr,m.sg,T.Hw,l.BZ,u.YE,l.w1,l.fO,l.ge,u.nU,m.O5,x.oG,l.Dz,l.ev,m.RF,m.n9,v.lW,m.ED,l.as,l.XQ,l.nj,l.Gk,p.NW],styles:["table[_ngcontent-%COMP%]{width:100%;margin:25px auto auto}.table-header[_ngcontent-%COMP%]{width:100%;margin:auto auto 10px;text-align:right;display:flex;align-items:center;justify-content:space-between}.btn-edit[_ngcontent-%COMP%]{text-align:right}.button-remove[_ngcontent-%COMP%]{color:red}.form-input[_ngcontent-%COMP%]{padding-right:5px}.link[_ngcontent-%COMP%]{display:inline-block;width:60px;white-space:nowrap;overflow:hidden!important;text-overflow:ellipsis}.icon-link[_ngcontent-%COMP%]{cursor:pointer;margin-left:10px}.default-column[_ngcontent-%COMP%]{max-width:200px;display:inline-block}.select-src[_ngcontent-%COMP%]{display:inline-block;width:70%;margin-right:5px}.button-clear[_ngcontent-%COMP%]{display:inline-block}"]}),i})();var z=s(508),K=s(6856),W=s(7322),X=s(7531),V=s(4107),q=s(3077);const nn=[{path:"",children:[{path:"",component:G}]}];let tn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[[m.ez,k.Bz.forChild(nn),q.x,l.p0,X.c,W.lN,p.TU,u.JX,v.ot,K.FA,z.XK,d.u5,x.p9,C.Is,V.LD,T.Ps]]}),i})()}}]);